# Security Headers Configuration for Secure_Share
# This file contains HTTP security headers to protect against 3rd party cookies and other security threats

# Prevent browsers from loading content from untrusted sources
# This Content Security Policy (CSP) blocks third-party cookies by restricting resource loading
Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self';"

# Prevent browsers from MIME-sniffing responses
Header always set X-Content-Type-Options "nosniff"

# Enable XSS protection in browsers
Header always set X-XSS-Protection "1; mode=block"

# Prevent clickjacking attacks
Header always set X-Frame-Options "DENY"

# Control referrer information to protect user privacy
Header always set Referrer-Policy "strict-origin-when-cross-origin"

# Enforce HTTPS connections
Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"

# Permissions Policy to restrict third-party access to browser features
# This prevents third-party iframes from accessing sensitive features
Header always set Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=()"

# Cookie Security Settings
# These settings should be applied to all cookies set by the application:
# - SameSite=Strict: Prevents cookies from being sent in cross-site requests (blocks 3rd party cookie usage)
# - Secure: Ensures cookies are only sent over HTTPS
# - HttpOnly: Prevents JavaScript access to cookies (mitigates XSS attacks)
#
# Example cookie header format:
# Set-Cookie: session_id=value; Path=/; Secure; HttpOnly; SameSite=Strict; Max-Age=3600
